(function(a, b) {
    function h(a, b) {
        var c = a.createElement("p")
          , d = a.getElementsByTagName("head")[0] || a.documentElement;
        return c.innerHTML = "x<style>" + b + "</style>",
        d.insertBefore(c.lastChild, d.firstChild)
    }
    function i() {
        var a = l.elements;
        return typeof a == "string" ? a.split(" ") : a
    }
    function j(a) {
        var b = {}
          , c = a.createElement
          , f = a.createDocumentFragment
          , g = f();
        a.createElement = function(a) {
            l.shivMethods || c(a);
            var f;
            return b[a] ? f = b[a].cloneNode() : e.test(a) ? f = (b[a] = c(a)).cloneNode() : f = c(a),
            f.canHaveChildren && !d.test(a) ? g.appendChild(f) : f
        }
        ,
        a.createDocumentFragment = Function("h,f", "return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&(" + i().join().replace(/\w+/g, function(a) {
            return b[a] = c(a),
            g.createElement(a),
            'c("' + a + '")'
        }) + ");return n}")(l, g)
    }
    function k(a) {
        var b;
        return a.documentShived ? a : (l.shivCSS && !f && (b = !!h(a, "article,aside,details,figcaption,figure,footer,header,hgroup,nav,section{display:block}audio{display:none}canvas,video{display:inline-block;*display:inline;*zoom:1}[hidden]{display:none}audio[controls]{display:inline-block;*display:inline;*zoom:1}mark{background:#FF0;color:#000}")),
        g || (b = !j(a)),
        b && (a.documentShived = b),
        a)
    }
    function p(a) {
        var b, c = a.getElementsByTagName("*"), d = c.length, e = RegExp("^(?:" + i().join("|") + ")$", "i"), f = [];
        while (d--)
            b = c[d],
            e.test(b.nodeName) && f.push(b.applyElement(q(b)));
        return f
    }
    function q(a) {
        var b, c = a.attributes, d = c.length, e = a.ownerDocument.createElement(n + ":" + a.nodeName);
        while (d--)
            b = c[d],
            b.specified && e.setAttribute(b.nodeName, b.nodeValue);
        return e.style.cssText = a.style.cssText,
        e
    }
    function r(a) {
        var b, c = a.split("{"), d = c.length, e = RegExp("(^|[\\s,>+~])(" + i().join("|") + ")(?=[[\\s,>+~#.:]|$)", "gi"), f = "$1" + n + "\\:$2";
        while (d--)
            b = c[d] = c[d].split("}"),
            b[b.length - 1] = b[b.length - 1].replace(e, f),
            c[d] = b.join("}");
        return c.join("{")
    }
    function s(a) {
        var b = a.length;
        while (b--)
            a[b].removeNode()
    }
    function t(a) {
        var b, c, d = a.namespaces, e = a.parentWindow;
        return !o || a.printShived ? a : (typeof d[n] == "undefined" && d.add(n),
        e.attachEvent("onbeforeprint", function() {
            var d, e, f, g = a.styleSheets, i = [], j = g.length, k = Array(j);
            while (j--)
                k[j] = g[j];
            while (f = k.pop())
                if (!f.disabled && m.test(f.media)) {
                    for (d = f.imports,
                    j = 0,
                    e = d.length; j < e; j++)
                        k.push(d[j]);
                    try {
                        i.push(f.cssText)
                    } catch (l) {}
                }
            i = r(i.reverse().join("")),
            c = p(a),
            b = h(a, i)
        }),
        e.attachEvent("onafterprint", function() {
            s(c),
            b.removeNode(!0)
        }),
        a.printShived = !0,
        a)
    }
    var c = a.html5 || {}, d = /^<|^(?:button|form|map|select|textarea|object|iframe)$/i, e = /^<|^(?:a|b|button|code|div|fieldset|form|h1|h2|h3|h4|h5|h6|i|iframe|img|input|label|li|link|ol|option|p|param|q|script|select|span|strong|style|table|tbody|td|textarea|tfoot|th|thead|tr|ul)$/i, f, g;
    (function() {
        var c = b.createElement("a");
        c.innerHTML = "<xyz></xyz>",
        f = "hidden"in c,
        f && typeof injectElementWithStyles == "function" && injectElementWithStyles("#modernizr{}", function(b) {
            b.hidden = !0,
            f = (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle).display == "none"
        }),
        g = c.childNodes.length == 1 || function() {
            try {
                b.createElement("a")
            } catch (a) {
                return !0
            }
            var c = b.createDocumentFragment();
            return typeof c.cloneNode == "undefined" || typeof c.createDocumentFragment == "undefined" || typeof c.createElement == "undefined"
        }()
    }
    )();
    var l = {
        elements: c.elements || "abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",
        shivCSS: c.shivCSS !== !1,
        shivMethods: c.shivMethods !== !1,
        type: "default",
        shivDocument: k
    };
    a.html5 = l,
    k(b);
    var m = /^$|\b(?:all|print)\b/
      , n = "html5shiv"
      , o = !g && function() {
        var c = b.documentElement;
        return typeof b.namespaces != "undefined" && typeof b.parentWindow != "undefined" && typeof c.applyElement != "undefined" && typeof c.removeNode != "undefined" && typeof a.attachEvent != "undefined"
    }();
    l.type += " print",
    l.shivPrint = t,
    t(b)
}
)(this, document);
(function($) {
    var escapeable = /["\\\x00-\x1f\x7f-\x9f]/g
      , meta = {
        '\b': '\\b',
        '\t': '\\t',
        '\n': '\\n',
        '\f': '\\f',
        '\r': '\\r',
        '"': '\\"',
        '\\': '\\\\'
    };
    $.toJSON = typeof JSON === 'object' && JSON.stringify ? JSON.stringify : function(o) {
        if (o === null) {
            return 'null'
        }
        var type = typeof o;
        if (type === 'undefined') {
            return undefined
        }
        if (type === 'number' || type === 'boolean') {
            return '' + o
        }
        if (type === 'string') {
            return $.quoteString(o)
        }
        if (type === 'object') {
            if (typeof o.toJSON === 'function') {
                return $.toJSON(o.toJSON())
            }
            if (o.constructor === Date) {
                var month = o.getUTCMonth() + 1
                  , day = o.getUTCDate()
                  , year = o.getUTCFullYear()
                  , hours = o.getUTCHours()
                  , minutes = o.getUTCMinutes()
                  , seconds = o.getUTCSeconds()
                  , milli = o.getUTCMilliseconds();
                if (month < 10) {
                    month = '0' + month
                }
                if (day < 10) {
                    day = '0' + day
                }
                if (hours < 10) {
                    hours = '0' + hours
                }
                if (minutes < 10) {
                    minutes = '0' + minutes
                }
                if (seconds < 10) {
                    seconds = '0' + seconds
                }
                if (milli < 100) {
                    milli = '0' + milli
                }
                if (milli < 10) {
                    milli = '0' + milli
                }
                return '"' + year + '-' + month + '-' + day + 'T' + hours + ':' + minutes + ':' + seconds + '.' + milli + 'Z"'
            }
            if (o.constructor === Array) {
                var ret = [];
                for (var i = 0; i < o.length; i++) {
                    ret.push($.toJSON(o[i]) || 'null')
                }
                return '[' + ret.join(',') + ']'
            }
            var name, val, pairs = [];
            for (var k in o) {
                type = typeof k;
                if (type === 'number') {
                    name = '"' + k + '"'
                } else if (type === 'string') {
                    name = $.quoteString(k)
                } else {
                    continue
                }
                type = typeof o[k];
                if (type === 'function' || type === 'undefined') {
                    continue
                }
                val = $.toJSON(o[k]);
                pairs.push(name + ':' + val)
            }
            return '{' + pairs.join(',') + '}'
        }
    }
    ;
    $.evalJSON = typeof JSON === 'object' && JSON.parse ? JSON.parse : function(src) {
        return eval('(' + src + ')')
    }
    ;
    $.secureEvalJSON = typeof JSON === 'object' && JSON.parse ? JSON.parse : function(src) {
        var filtered = src.replace(/\\["\\\/bfnrtu]/g, '@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']').replace(/(?:^|:|,)(?:\s*\[)+/g, '');
        if (/^[\],:{}\s]*$/.test(filtered)) {
            return eval('(' + src + ')')
        } else {
            throw new SyntaxError('Error parsing JSON, source is not valid.')
        }
    }
    ;
    $.quoteString = function(string) {
        if (string.match(escapeable)) {
            return '"' + string.replace(escapeable, function(a) {
                var c = meta[a];
                if (typeof c === 'string') {
                    return c
                }
                c = a.charCodeAt();
                return '\\u00' + Math.floor(c / 16).toString(16) + (c % 16).toString(16)
            }) + '"'
        }
        return '"' + string + '"'
    }
}
)(jQuery);
function str_replace(a, b, c) {
    if (!(b instanceof Array)) {
        b = new Array(b);
        if (a instanceof Array) {
            while (a.length > b.length) {
                b[b.length] = b[0]
            }
        }
    }
    if (!(a instanceof Array))
        a = new Array(a);
    while (a.length > b.length) {
        b[b.length] = ''
    }
    if (c instanceof Array) {
        for (k in c) {
            c[k] = str_replace(a, b, c[k])
        }
        return c
    }
    for (var k = 0; k < a.length; k++) {
        var i = c.indexOf(a[k]);
        while (i > -1) {
            c = c.replace(a[k], b[k]);
            i = c.indexOf(a[k], i)
        }
    }
    return c
}
function formatPrice(x) {
    return x.toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ")
}
function substr_count(haystack, needle, offset, length) {
    var pos = 0
      , cnt = 0;
    if (isNaN(offset))
        offset = 0;
    if (isNaN(length))
        length = 0;
    offset--;
    while ((offset = haystack.indexOf(needle, offset + 1)) != -1) {
        if (length > 0 && (offset + needle.length) > length) {
            return !1
        } else {
            cnt++
        }
    }
    return cnt
}
var part_id;
function addFile(link) {
    $(link).parent().append($(link).prev().clone());
    return !1
}
var widjet;
function calculated(params){
    //console.log(params);
    $("div.calcPrice .dostavka").show();

    if($("#youraddress").is(":visible")){
        $("#dostavka1").html("Курьер: "+(parseInt(params.profiles.courier.price) + 50)+"<i class=\"rub\">Р<hr></i> (дни: "+params.profiles.courier.term+")").show();
        $("#dostavka2").hide();
        $("#deliveryWidgetResult").find("p:nth-child(3)").text("Стоимость доставки: "+(parseInt(params.profiles.courier.price) + 50)+" руб.");
    }
    else {
        $("#dostavka2").html("Самовывоз: "+(parseInt(params.profiles.pickup.price) + 50)+"<i class=\"rub\">Р<hr></i> (дни: "+params.profiles.pickup.term+")").show();
        $("#dostavka1").hide();
        $("#deliveryWidgetResult").find("p:nth-child(4)").text("Стоимость доставки: "+(parseInt(params.profiles.pickup.price) + 50)+" руб.");
    }
}
$(function() {
    $(document).ready(function() {
        $("a.question_slider").on("click", function(e){
            e.preventDefault();
            e.stopPropagation();

            $(this).toggleClass('arrow-up').toggleClass('arrow-down').parent().next().toggle();

            return false;
        });

        $('div.footer_information').text('Обращаем Ваше внимание на то, что вся представленная на сайте информация, касающаяся технических характеристик, типов материала, а также цен на продукцию носит информационный характер и ни при каких условиях не является публичной офертой, определяемой положениями Статьи 437 (2) Гражданского кодекса Российской Федерации. Для получения подробной информации, пожалуйста, обращайтесь к менеджерам компании ИП Захаров С.Н..');

        $(".iagree_form_block").html('<div style="width: 340px; display: inline-block; font-size: 15px;">'
            +'Я согласен с <a target="_blank" href="/pravila-prodazhi-tovarov-i-uslug-v-internet-magazine-a-cifra/">Пользовательским соглашением</a></div>'
            +'<p style="font-size:10px; color: #8f6c6c; line-height: 11px;">Мы гарантируем, что Ваши данные не будут использованы для рассылки нежелательной информации и ни при каких условиях не будут переданы третьим лицам</p>'
        );

        $("div.dizain-poligrafii-postload").html(
            '<p><span class="title">Уровни сложности дизайна:</span></p>'+
            '<p style="font-size:16px;">Наша компания готова выполнить дизайн визиток и другой печатной продукции, поэтому если у вас нет готового макета и собственных наработок, вы можете заказать необходимый тираж, воспользовавшись профессиональными услугами. Однако важно знать, что существует разделение уровней сложности дизайна по категориям:</p>'+
            '<p>&nbsp;</p>'+
            '<h3>Категория №1</h3>'+
            '<p style="font-size:16px;">Подготовка макета на основании материалов, предоставленных заказчиком (сюда входит - развёрнутое техзадание, рабочие эскизы, примеры готовых вариантов, текстовая, графическая информация, а также фотографии и рисунки, не нуждающиеся в корректировке). Кроме того, заказчик должен сам определить основные цвета, порядок размещения и размер фигур в макете. Эта разновидность эскиза отличается оперативным исполнением и невысокой ценой.</p>'+
            '<ul>'+
                '<li>'+
                '<p style="font-size:16px;">В результате: заказчик получает готовый макет с одним эскизом и тремя бесплатными правками. Все дополнительные услуги не входят в стоимость основного заказа и оплачиваются отдельно.</p>'+
                '</li>'+
            '</ul>'+
            '<h3>Категория №2</h3>'+
            '<p style="font-size:16px;">Подготовка макета с формированием эскизов и подбором иллюстраций. Данная категория подразумевает предоставление заказчиком текстовой информации, рисунков и фотографий, нуждающихся в поверхностной обработке, а также предпочтений к расположению элементов. Подготовку и создание макета выполняют дизайнеры нашей типографии.</p>'+
            '<ul>'+
                '<li>'+
                '<p style="font-size:16px;">В результате: заказчик получает готовый макет с одним эскизом и тремя бесплатными правками. Все дополнительные услуги не входят в стоимость основного заказа и оплачиваются отдельно.</p>'+
                '</li>'+
            '</ul>'+
            '<h3>Категория №3</h3>'+
            '<p style="font-size:16px;">Формирование концепции и подготовка макета без наличия дополнительных материалов по указанной заказчиком теме. Всё, что требуется от заказчика &ndash; предоставить текстовую информацию, остальная часть работ полностью перекладывается на дизайнеров нашей компании.</p>'+
            '<ul>'+
                '<li>'+
                '<p style="font-size:16px;">В результате: заказчик получает готовый макет с одним эскизом и тремя бесплатными правками. Все дополнительные услуги не входят в стоимость основного заказа и оплачиваются отдельно.</p>'+
                '</li>'+
            '</ul>'+
            '<p style="font-size:16px;">Внимание! Отдельно стоит упомянуть о том, что сложность, соответственно - стоимость и сроки изготовления макета определяется менеджером нашей компании!</p>'
        );

        ymaps.ready(function(){
            if(!$("#tow").text()){
                var geolocation = ymaps.geolocation;
                $('#tow').html(geolocation.city);

                widjet = new ISDEKWidjet({
                    defaultCity: geolocation.city,
                    cityFrom: 'Москва',
                    country: 'Россия', // можно выбрать страну, для которой отображать список ПВЗ
                    link: false,
                    popup: true,
                    path: 'https://widget.cdek.ru/widget/scripts/', //директория с библиотеками
                    servicepath: '/service.php', //ссылка на файл service.php на вашем сайте
                    goods: [{
            			length: 17,
            			width: 12,
            			height: 10,
            			weight: 0.5
            		}],
                    onChoose: onChoose,
                    onChooseProfile: onChooseProfile,
                    onCalculate: calculated
                });
            }
        });

        $("#tow").on("click", function(e) {
            e.preventDefault();
            e.stopPropagation();

            var tow = $(this);
            tow.parent().toggleClass("active");

            if($("div.townChoicePreview").length){
                $("div.townChoicePreview").remove();
            }
            else {
                $("#tow_container").append(
                    $("<div class='townChoicePreview'></div>")
                        .append("<span>Вы находитесь:</span>")
                        .append("<strong>"+tow.text()+"?</strong>")
                        .append("</br></br>")
                        .append(
                            $("<a href='#'>Да, все верно</a>").on("click", function(e) {
                                e.preventDefault();
                                e.stopPropagation();

                                $(this).parent().remove();
                                tow.parent().toggleClass("active");
                            })
                        )
                        .append(
                            $("<a href='#'>Сменить</a>").on("click", function(e) {
                                e.preventDefault();
                                e.stopPropagation();

                                $(this).parent().remove();
                                tow.parent().toggleClass("active");

                                $('div.background').toggle();
                                $('div.townChoice').toggle();
                            })
                        )
                        .append("<div class='clear'></div>")
                );
            }

            return !1
        });
        $("div.townChoice .toggleTownsList").on("click", function(e){
            e.preventDefault();
            e.stopPropagation();

            $(this).next().toggle();

            $(this).text($(this).text() == "показать все города (22)" ? "скрыть города" : "показать все города (22)");

            return false;
        });
        $("div.townChoice > .townList > a").on("click", function(e){
            e.preventDefault();
            e.stopPropagation();

            if($(this).parent().hasClass("moscow")){
                $(this).parent().find("a").removeClass("active");
                $(this).addClass("active");

                $("#tow").append(", "+$(this).text());

                $('div.background').toggle();
                $('div.townChoice').toggle();
            }
            else if($(this).hasClass("moscow")){
                $("div.townChoice a").removeClass("active");
                $("#tow").text($(this).text());
                $(this).addClass("active");

                $("div.townChoice .townList.moscow").show();
                $("div.townChoice .townList.moscow").prev().show();
            }
            else {
                $("div.townChoice a").removeClass("active");
                $(this).addClass("active");

                $("div.townChoice .townList.moscow").hide();
                $("div.townChoice .townList.moscow").prev().hide();
                $("#tow").text($(this).text());

                $('div.background').toggle();
                $('div.townChoice').toggle();
            }

            $.post(
                "/newcalcshow2.php?settow=city",
                {
                    "term":$("#tow").text()
                },
                function(data) { },
                "json"
            );

            return false;
        });

        if($("#townSelection").length){
            $("#townSelection").find("input[name=city_title]:first")
            .autocomplete({
                source:function(request,action){
                    $.post(
                        "/newcalcshow2.php?search=cities",
                        {
                            "term":request.term
                        },
                        function(data) {
                            if(data.length) {
                                action(data);
                            }
                            else {
                                action([]);
                            }
                        },
                        "json"
                    );
                },
                minLength:3,
                autoFocus:true,
                select:function(event,ui){
                    $("#tow").text(ui.item.label);
                    $('div.background').toggle();
                    $('div.townChoice').toggle();

                    $.post(
                        "/newcalcshow2.php?settow=city",
                        {
                            "term":$("#tow").text()
                        },
                        function(data) { },
                        "json"
                    );

                    return false;
                }
            })
            .data("uiAutocomplete")
            ._renderItem = function(ul,item) {
                return $("<li style=\"border-bottom:dashed 1px #9fa8b7;\"></li>")
                    .data("item.autocomplete",item)
                    .append("<a>"+item.label+"<br /><small >"+item.country_region+"</small></a>" )
                    .appendTo(ul);
            };
        }

        $("#goUp").click(function() {
            $('html, body').animate({
                scrollTop: '0px'
            }, "fast");
            return !1
        });
        $(window).scroll(function() {
            var shift = 500;
            if ($(window).scrollTop() <= $(".main").offset().top + shift) {
                $("#goUp").hide()
            } else {
                $("#goUp").show()
            }
        });
        var phone = $('.phone');
        var str = phone.html();
        if (str) {
            var length = str.length;
            var str_new = '';
            for (i = 0; i < length; i++) {
                find = !1;
                for (x = 0; x <= 9; x++) {
                    if (x == str[i] && str[i] != ' ') {
                        str_new += '<b>' + str[i] + '</b>';
                        find = !0
                    }
                }
                if (!find)
                    str_new += str[i]
            }
            phone.html('<a href="tel:' + str + '">' + str_new + '</a>')
        }
    });
    function setMenu() {
        var bodyWidth = $('body').width();
    }
    function setWidth() {
        $('.favorite').removeClass('w1024');
        if ($(window).width() < 1200) {
            $('.header-text, .splash-left').addClass('w1024')
        } else {
            $('.header-text, .splash-left').removeClass('w1024')
        }
    }
    function buttonClick() {
        var top;
        $('.button').unbind('std').each(function() {
            $(this).bind('mousedown.std', function() {
                top = parseInt(str_replace('px', '', $(this).css('top')));
                top_click = top + 1;
                $(this).css('top', top_click + 'px')
            }).bind('mouseup.std', function() {
                top_click = parseInt(str_replace('px', '', $(this).css('top')));
                top = top_click - 1;
                $(this).css('top', top + 'px')
            })
        })
    }
    function actionSlider() {
        window.nextSlide = function() {
            if (img[current_slide + 1]) {
                current_slide++
            } else {
                current_slide = 0
            }
            var action = $('.action');
            action.find('img').before(img[current_slide]);
            action.find('img:first').css({
                'position': 'absolute',
                'z-index': 100,
                'opacity': 0.01
            });
            action.find('img:first').animate({
                'opacity': '1'
            }, 600);
            action.find('img:eq(1)').animate({
                'opacity': '0.01'
            }, 500);
            action.find('.text').animate({
                'font-size': '6px'
            }, 200);
            action.find('.text span').animate({
                'font-size': '6px'
            }, 200, function() {
                action.find('.text').stop();
                action.find('.text').html(text[current_slide]);
                action.find('.text span').css('font-size', '0');
                action.find('.text').animate({
                    'font-size': '18px'
                }, 300);
                action.find('.text span').animate({
                    'font-size': '15px'
                }, 300, function() {
                    action.find('img:eq(1)').remove();
                    action.find('img').css({
                        'position': 'relative',
                        'float': 'left'
                    });
                    action.find('.discount').html(discount[current_slide]);
                    setTimeout("window.nextSlide()", 5000)
                })
            });
            $('.action .button').click(function() {
                document.location.href = '/order/'
            })
        }
        var current_slide = 0;
        var discount, img, text;
        discount = new Array();
        img = new Array();
        text = new Array();
        $('.action').each(function(i) {
            discount.push($(this).find('.discount').html());
            img.push($(this).find('img'));
            text.push($(this).find('.text').html());
            if (i > 0) {
                $(this).remove()
            }
        });
        $('.action .button').click(function() {
            document.location.href = '/order/'
        });
        setTimeout("window.nextSlide()", 5000);
        $('.actions').css('overflow', 'visible')
    }
    function AddToBookmark(a, type) {
        if (type == "main") {
            title = "Цифровая типография А-ЦИФРА";
            url = "http://www.a-cifra.ru"
        } else {
            title = document.title;
            url = document.location
        }
        try {
            window.external.AddFavorite(url, title)
        } catch (e) {
            try {
                window.sidebar.addPanel(title, url, "")
            } catch (e) {
                if (typeof (opera) == "object") {
                    a.rel = "sidebar";
                    a.title = title;
                    a.url = url;
                    return !0
                } else {
                    alert('Для добавления страницы в Избранное нажмите Ctrl+D')
                }
            }
        }
        return !1
    }
    $('#favorite').click(function() {
        return AddToBookmark($(this))
    });
    $('a.addToFavourite').click(function() {
        return AddToBookmark($(this), "main")
    });
    actionSlider();
    setMenu();
    setWidth();
    buttonClick();
    $(window).resize(function() {
        setMenu();
        setWidth()
    })
});
$(function() {
    $("div.kupon > a.printthis").click(function() {
        var kupon = $(this).parent().clone();
        kupon.find("p").css("margin-bottom", "20px");
        kupon.find("a.printthis").remove();
        kupon.find("a.giveaway").remove();
        kupon.printThis();
        return !1
    });
    $("div.kupon > a:last").click(function() {
        if ($("div.sendtofriend").length == 0) {
            $("form.sendfriend").toggle()
        } else {
            $("form.sendfriend").html("<p>Вы уже отправили подарок</p>").toggle()
        }
        return !1
    });
    $("input[name=mode]").val("wire");
    if ($("#scrollerArea").attr('id')) {
        $("#scrollerArea .left").click(goLeft);
        $("#scrollerArea .right").click(goRight);
    }
    if ($("#scrollerArea2").attr('id')) {
        $("#scrollerArea2 .left").click(goLeft2);
        $("#scrollerArea2 .right").click(goRight2)
    }
    $("a.sendbackcall").click(function() {
        var form = $(this).parent();

        if (!form.find(".agreement").is(":checked")) {
            form.find(".input_confirm").text("Подтвердите свое согласие на обработку персональных данных")
        } else {
			var submit = !0;
			if (!checkField('name5', 'Укажите ваше имя', !1, form, "#000000") || !checkField('phone5', 'Укажите контактный телефон', !1, form, "#000000")) {
				var submit = !1
			}
			if (submit) {
				sendForm(form)
			}
        }
    });
    $("div.background").click(function() {
        $('div.background').toggle();
        $('div.mailtodirector').hide();
        $('div.orderform').hide();
        $('div.mailseekpartners').hide();
        $('div.backcall').hide();
        $('div.townChoice').hide();
        return !1
    });
    $("#closeForm5").click(function() {
        $('div.background').hide();
        $('div.mailtodirector').hide();
        $('div.orderform').hide();
        $('div.mailseekpartners').hide();
        $('div.backcall').hide();
        $('div.townChoice').hide();
        return !1
    });
    $("#closeForm4").click(function() {
        $('div.background').hide();
        $('div.mailtodirector').hide();
        $('div.orderform').hide();
        $('div.mailseekpartners').hide();
        $('div.backcall').hide();
        $('div.townChoice').hide();
        return !1
    });
    $("#closeForm").click(function() {
        $('div.background').hide();
        $('div.mailtodirector').hide();
        $('div.orderform').hide();
        $('div.mailseekpartners').hide();
        $('div.backcall').hide();
        $('div.townChoice').hide();
        return !1
    });
    $("#closeForm2").click(function() {
        $('div.background').hide();
        $('div.mailtodirector').hide();
        $('div.orderform').hide();
        $('div.mailseekpartners').hide();
        $('div.backcall').hide();
        $('div.townChoice').hide();
        return !1
    });
    $("#closeForm3").click(function() {
        $('div.background').hide();
        $('div.mailtodirector').hide();
        $('div.orderform').hide();
        $('div.mailseekpartners').hide();
        $('div.backcall').hide();
        $('div.townChoice').hide();
        return !1
    });

    $("#backcall").click(function() {
        $('div.background').toggle();
        $('div.backcall').toggle();
        return !1
    });
    $("#backcall2").click(function() {
        $('div.background').toggle();
        $('div.backcall').toggle();
        return !1
    });
    $("a.backcalls").click(function() {
        $('select[name=meth]').hide();
        $('div.mailtodirector > span').text("СДЕЛАТЬ ЗАКАЗ");
        $('div.mailtodirector input[name="email2"]').removeAttr("readonly");
        if ($(this).parent().parent().hasClass("ymblock")) {
            $('div.mailtodirector input[name="type2"]').val("ymmarket");
        } else {
            $('div.mailtodirector input[name="type2"]').val("addOrderWithDiscount");
        }
        $('div.background').toggle();
        $('div.mailtodirector').toggle();
        return !1
    });
    $("#mailtodirector").click(function() {
        $('select[name=meth]').show();
        $('div.mailtodirector > span').text("НАПИСАТЬ ДИРЕКТОРУ");
        $('div.mailtodirector input[name="email2"]').removeAttr("readonly");
        $('div.mailtodirector input[name="type2"]').val("todirector");
        $('div.background').toggle();
        $('div.mailtodirector').toggle();
        return !1
    });
    $("a.addOrderWithDiscount").click(function() {
        $('div.mailtodirector > span').text("СДЕЛАТЬ ЗАКАЗ");
        $('div.mailtodirector input[name="email2"]').val($(this).attr("data-value")).attr("readonly", "true");
        if ($(this).parent().parent().hasClass("btblock")) {
            yaCounter21621268.reachGoal('1click');
            $('div.mailtodirector input[name="email2"]').val($("h1:first").text()).attr("readonly", "true");
            $('select[name=meth]').hide();
            $('div.mailtodirector input[name="type2"]').val("btblock");
        }
        else if ($(this).parent().parent().hasClass("ymblock")) {
            $('div.mailtodirector input[name="email2"]').val($("h1:first").text()).attr("readonly", "true");
            $('select[name=meth]').hide();
            $('div.mailtodirector input[name="type2"]').val("ymmarket");
        } else {
            $('select[name=meth]').show();
            $('div.mailtodirector input[name="type2"]').val("addOrderWithDiscount");
        }
        $('div.background').toggle();
        $('div.mailtodirector').toggle();
        return !1
    });
    $("a.sendtodirector").click(function() {
        var form = $(this).parent();
        if (!form.find(".agreement").is(":checked")) {
            form.find(".input_confirm").text("Подтвердите свое согласие на обработку персональных данных")
        } else {
            form.find(".input_confirm").text("");
            var submit = !0;
            if (form.find("input[name=type2]").val() == "todirector") {
                if (!checkField('name2', 'Укажите ваше имя', !1, form, "#000000") || !checkField('phone2', 'Укажите контактный телефон', !1, form, "#000000") || !checkField('email2', 'Укажите контактный email', !0, form, "#000000") || !checkField('message2', 'Напишите ваш вопрос или комментарий', !1, form, "#000000")) {
                    var submit = !1
                }
            }
            if (submit) {
                sendForm(form)
            }
        }
        return !1
    });
    signature("name3", "Представьтесь");
    signature("email3", "E-mail")
});
var isScrolling = !1;
var blockWidth2 = 350;
var padding2 = 10;
function goRight2() {
    if (isScrolling == !1) {
        isScrolling = !0;
        var lp = $("#scrollerArea2 div.scroller").position().left;
        var scrollerWidth = $("#scrollerArea2").width();
        var bc = $("#scrollerArea2 div.scroller div.scritems a").length;
        var allWidth = blockWidth2 * bc + padding2 * (bc - 1);
        var limit = allWidth - scrollerWidth;
        if (limit > (lp * (-1))) {
            $("#scrollerArea2 div.scroller").animate({
                left: lp - (blockWidth2 + padding2) + "px"
            }, function() {
                isScrolling = !1
            })
        } else {
            isScrolling = !1;
            $("#scrollerArea2 div.scroller").css("left", 0)
        }
    }
    return !1
}
function goLeft2() {
    if (isScrolling == !1) {
        isScrolling = !0;
        var lp = $("#scrollerArea2 div.scroller").position().left;
        if (lp < 0) {
            $("#scrollerArea2 div.scroller").animate({
                left: lp + (blockWidth2 + padding2) + "px"
            }, function() {
                isScrolling = !1
            })
        } else {
            isScrolling = !1
        }
    }
    return !1
}
$(function() {
    $("div.table_broshura").find("tr").removeClass("second");
    $("div.table_broshura").find("tr:odd").css("background-color", "#f5f5f5")
});
function setPhone() {
    var phone = '+7 (495) 109-01-03';
    var source = get_cookie('source_type');
    switch (source) {
    case "remarketing":
        phone = '+7 (495) 109-01-03';
        break;
    case "search":
        phone = '+7 (495) 109-01-03';
        break;
    case "yandexdirect":
        phone = '+7 (499) 685-17-56';
        break;
    case "yandex":
        phone = '+7 (499) 685-18-31';
        break;
    case "google":
        phone = '+7 (499) 685-17-61';
        break;
    case "gis":
        phone = '+7 (495) 229-93-27';
        break;
    case "yell":
        phone = '+7 (499) 685-17-28';
        break;
    case "vk":
        phone = '+7 (499) 685-16-89';
        break;
    case "mail":
        phone = '+7 (499) 685-16-49';
        break;
    case "pechatnick":
        phone = '+7 (499) 685-18-59';
        break;
    case "googleadwords":
        phone = '+7 (499) 685-17-46';
        break
    }
    if (source != 'direct' && phone != '')
        $('.phone').text(phone)
}
function get_cookie(cookie_name) {
    var results = document.cookie.match('(^|;) ?' + cookie_name + '=([^;]*)(;|$)');
    if (results)
        return (unescape(results[2]));
    else
        return null
}
function sendForm(form) {
    form.find("input[name=mode]").val("wire");
    $.post("/services/", form.serialize(), function(result) {
        if (form.find("a.sendtodirector").length > 0 && form.find("input[name=type2]").val() == "todirector") {
			try{
				yaCounter21621268.reachGoal('sendtodirector');
				ga('send', 'event', 'Director', 'send');
			} catch (e) {}
        }
        if(form.find("a.sendtodirector").length > 0 && form.find("input[name=type2]").val() == "ymmarket"){
            yaCounter21621268.reachGoal('ordermarket');
            // ym(21621268,'reachGoal','ordermarket');
        }

		if (!!window.send_calltouch){ window.send_calltouch(form); }

        form.html("<p>Ваше сообщение отправлено.</p>");
        setTimeout(function() {
            $('div.background').hide();
            $('div.mailtodirector').hide();
            $('div.orderform').hide();
            $('div.mailseekpartners').hide();
            $('div.backcall').hide()
        }, 4000)
    }, "json");
    return !1
}
function signature(name, text, field) {
    field = (field) ? "textarea" : "input";
    var field = $(field + "[name=" + name + "]");
    field.focus(function() {
        if (field.val() == text)
            field.val("").css("color", "#302F2F")
    }).blur(function() {
        if (field.val() == "")
            field.val(text).css("color", "#BCBCBC")
    })
}
function goRight() {
    if (isScrolling == !1) {
        isScrolling = !0;
        var lp = $("#scrollerArea div.scroller").position().left;
        var scrollerWidth = $("#scrollerArea").width();
        var allWidth = 0;
        $("#scrollerArea div.scroller div.scritems a").each(function() {
            allWidth += $(this).width() + 65
        });
        allWidth -= 65;
        var limit = allWidth - scrollerWidth;
        if (limit > (lp * (-1))) {
            $("#scrollerArea div.scroller").animate({
                left: lp - (scrollerWidth + 65) + "px"
            }, function() {
                isScrolling = !1
            })
        } else {
            isScrolling = !1;
            $("#scrollerArea div.scroller").css("left", 0)
        }
    }
    return !1
}
function goLeft() {
    if (isScrolling == !1) {
        isScrolling = !0;
        var scrollerWidth = $("#scrollerArea").width();
        var lp = $("#scrollerArea div.scroller").position().left;
        if (lp < 0) {
            $("#scrollerArea div.scroller").animate({
                left: lp + (scrollerWidth + 65) + "px"
            }, function() {
                isScrolling = !1
            })
        } else {
            isScrolling = !1
        }
    }
    return !1
}

$(function() {
    $('.menu_block').find("a.menu_top_arrow").each(function(){
        $(this).on("click", function(e){
            e.preventDefault();
            e.stopPropagation();

            $(this).parent().find("div.sub:first").toggle();

            return false;
        });
    });

    $("a.goto").on("click", function(e){
        e.preventDefault();
        e.stopPropagation();

        $('html, body').animate({
            scrollTop: $("."+$(this).data("goto")).offset().top
        }, 500);

        return false;
    });

    $('.hamburger').click(function() {
        $('.upper_block .site div').toggle();
        $('.menu_block').toggle();

        return false;
    });
    $("input[name=phone6]").mask("+7 (999) 999-9999");
    $("input[name=phone7]").mask("+7 (999) 999-9999");

    if($("#main-slider").length){
        var slider = $("#main-slider").slippry({
            useCSS: true,

            slippryWrapper: '<div class="sy-box" />',
            elements: 'div.image-content',

            adaptiveHeight: false,
            captions: false,

            transition: 'horizontal',
            speed: 1200,
            pause: 8000,

            autoDirection: 'next'
        });
    }
    else {
        $.get('/get_main_slider/', function(slider){
            $('div.mainb>.site').html(slider);
            var slider = $("#main-slider").slippry({
                useCSS: true,

                slippryWrapper: '<div class="sy-box" />',
                elements: 'div.image-content',

                adaptiveHeight: false,
                captions: false,

                transition: 'horizontal',
                speed: 1200,
                pause: 8000,

                autoDirection: 'next'
            });
        }, 'html');
    }

    $('.stop').click(function() {
        slider.stopAuto();
    });
    $('.start').click(function() {
        slider.startAuto();
    });
    $('.prev').click(function() {
        slider.goToPrevSlide();
        return false;
    });
    $('.next').click(function() {
        slider.goToNextSlide();
        return false;
    });
    $('.reset').click(function() {
        slider.destroySlider();
        return false;
    });
    $('.reload').click(function() {
        slider.reloadSlider();
        return false;
    });
    $('.init').click(function() {
        slider = $("#main_slider").slippry();
        return false;
    });

    $("div.order_line form a").on("click", function(e) {
        e.preventDefault();
        e.stopPropagation();

        var form = $(this).parent();

        var submit = !0;
        if (!checkField('name6', 'Иванов Иван', !1, form, "#000000") || !checkField('phone6', '+7 (495) 109-01-03', !1, form, "#000000")) {
            var submit = !1
        }
        if (submit) {
            form.find("input[name=mode]").val("wire");
            $.post("/", form.serialize(), function(result) {
                form.html("<strong>Сообщение отправлено!</strong>");
            }, "json");

			if (!!window.send_calltouch){ window.send_calltouch(form); }
        }

        return false;
    });

    $("div.orderform form a").on("click", function(e) {
        if($(this).closest("form").find("input[name=maket]").length){
            $(this).parent().submit();
            return false;
        }
        else {
            e.preventDefault();
            e.stopPropagation();

            var form = $(this).parent();

            var submit = !0;
            if (!checkField('name7', 'Иванов Иван', !1, form, "#000000") || !checkField('phone7', '+7 (495) 109-01-03', !1, form, "#000000")) {
                var submit = !1
            }
            if (submit) {
                form.find("input[name=mode]").val("wire");
                $.post("", form.serialize(), function(result) {
                    form.html("<strong>Сообщение отправлено!</strong>");
                }, "json");

    			if (!!window.send_calltouch){ window.send_calltouch(form); }
            }

            return false;
        }
    });

    if($('.owl-carousel.owl-responces').is(':visible')){
        var owl = $('.owl-carousel.owl-responces');
        owl.owlCarousel({
            loop: true,
            nav: true,
            dots: ($("body").width() < 500 ? false : true),
            navText: ["", ""],
            responsive: {
                320: {
                    items: 1
                },
                600: {
                    items: 1
                },
                1000: {
                    items: 1
                }
            }
        });
    }

    if($('.owl-carousel.owl-main').is(':visible')){
        var owl = $('.owl-carousel.owl-main');
        owl.owlCarousel({
            loop: true,
            margin: 40,
            nav: true,
            dots: ($("body").width() < 500 ? false : true),
            navText: ["", ""],
            responsive: {
                320: {
                    items: 1
                },
                600: {
                    items: 2
                },
                1000: {
                    items: 4
                }
            }
        });
    }

    if(!$('a[data-tab="paper"]').length){
        var owl = $('.owl-carousel.owl-paper');
        owl.owlCarousel({
            loop: true,
            margin: 40,
            nav: true,
            dots: false,
            navText: ["", ""],
            responsive: {
                320: {
                    items: 1
                },
                600: {
                    items: 2
                },
                1000: {
                    items: 4
                }
            }
        });
    }

    if($('.owl-carousel.owl-example3').is(':visible')){
        var owl = $('.owl-carousel.owl-example3');
        owl.owlCarousel({
            loop: true,
            margin: 40,
            nav: true,
            dots: false,
            navText: ["", ""],
            responsive: {
                320: {
                    items: 1
                },
                600: {
                    items: 2
                },
                1000: {
                    items: 3
                }
            }
        });
    }

    $("#seekpartners").click(function() {
        $('div.background').toggle();
        $('div.mailseekpartners').toggle();
        return !1
    });

    $(".orderformcaller").click(function() {
        if($(this).hasClass("withphoto")){
            $('div.orderform').find("input[name=email7]").after('Выбрать свой образец: <input type="file" name="maket" />');
        }
		if($(this).data("aktsia")){
			$('div.orderform').find("form").append("<input type=\"hidden\" name=\"additionalinfo\ value=\"aktsia\"/>");
		}
        $('div.background').toggle();
        $('div.orderform').toggle();
        return !1
    });

    $("a.sendseekpartners").click(function() {
        var form = $(this).parent();
        if (!form.find(".agreement").is(":checked")) {
            form.find(".input_confirm").text("Подтвердите свое согласие на обработку персональных данных")
        } else {
            form.find(".input_confirm").text("");
            var submit = !0;
            if (form.find("input[name=type2]").val() == "seekpartners") {
                if (!checkField('name2', 'Укажите ваше имя', !1, form, "#000000") || !checkField('phone2', 'Укажите контактный телефон', !1, form, "#000000") || !checkField('email2', 'Укажите контактный email', !0, form, "#000000") || !checkField('message2', 'Напишите ваш вопрос или комментарий', !1, form, "#000000")) {
                    var submit = !1
                }
            }

            if (submit) {
                sendForm(form)
            }
        }
        return !1
    });

    if ($("#scrollerArea3").attr('id')) {
        $("#scrollerArea3 .left").click(goLeft3);
        $("#scrollerArea3 .right").click(goRight3)
    }

    var blockWidth3 = 1200;
    function goRight3() {
        if (isScrolling == !1) {
            isScrolling = !0;
            var lp = $("#scrollerArea3 div.scroller").position().left;
            var scrollerWidth = $("#scrollerArea3").width();
            var bc = $("#scrollerArea3 div.scroller div.scritems div").length;
            var allWidth = blockWidth3 * bc * (bc - 1);
            var limit = allWidth - scrollerWidth;
            if (limit > (lp * (-1))) {
                $("#scrollerArea3 div.scroller").animate({
                    left: lp - (blockWidth3) + "px"
                }, function() {
                    isScrolling = !1
                })
            } else {
                isScrolling = !1;
                $("#scrollerArea3 div.scroller").css("left", 0)
            }
        }
        return !1
    }

    function goLeft3() {
        if (isScrolling == !1) {
            isScrolling = !0;
            var lp = $("#scrollerArea3 div.scroller").position().left;
            if (lp < 0) {
                $("#scrollerArea3 div.scroller").animate({
                    left: lp + (blockWidth3) + "px"
                }, function() {
                    isScrolling = !1
                })
            } else {
                isScrolling = !1
            }
        }
        return !1
    }
});

/* send calltouch */
window.send_calltouch = function(form){
	try {
		var fio = form.find('input[name*="name"]').val();
		var phone = form.find('input[name*="phone"]').val();
		var mail = form.find('input[name*="email"]').val();
		var ct_site_id = '34785';
		var sub = 'Заявка';
		if (!!form.find('a[href="#"]').attr('class')) {
			if (form.find('a[href="#"]').hasClass('sendorderform')){ sub = 'Заказ'; }
			if (form.find('a[href="#"]').hasClass('makeCalcOrder')){ sub = 'Заказ'; }
			if (form.find('a[href="#"]').hasClass('sendbackcall')){ sub = 'Обратный звонок'; }
		}
		var ct_data = {
			fio: fio,
			phoneNumber: phone,
			email: mail,
			subject: sub,
			sessionId: window.call_value
		};
		if (!!phone || !!mail){
			jQuery.ajax({
			  url: 'https://api-node13.calltouch.ru/calls-service/RestAPI/requests/'+ct_site_id+'/register/',
			  dataType: 'json', type: 'POST', data: ct_data, async: false
			});
		}
	} catch(e) { }
}
/* send calltouch */
